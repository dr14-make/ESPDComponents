# ============================================================================
# Electric Motor Test: Regenerative Braking
# ============================================================================
#
# Objective: Verify generator mode operation
# Expected: Negative current, motor decelerates, power flows back
#
# Reference: Documentation/ElectricMotor.md
#
# TODO: Instantiate your ElectricMotor component
# Example:
# motor = ElectricMotor(
# K_e = 0.1,
# K_t = 0.1,
# R = 0.5,
# J = 0.01
# )
#
# TODO: Add voltage source and initial speed
# Example:
# voltage_source = ElectricalComponents.VoltageSource()
# voltage_cmd = BlockComponents.Step(height = 12.0, startTime = 0.5)  # Reduce voltage at t=0.5s
# ground = ElectricalComponents.Ground()
#
# TODO: Connect components
# Example:
# connect(voltage_cmd.y, voltage_source.V_input)
# connect(voltage_source.p, motor.p)
# connect(voltage_source.n, ground.g)
# connect(motor.n, ground.g)
#
# TODO: Set initial conditions (motor spinning)
# Example:
# initial motor.flange.phi = 0.0
# initial der(motor.flange.phi) = 400.0  # Start at high speed (400 rad/s)
#
# TODO: Add analysis
# Example:
# analysis TestElectricMotor_Regeneration_Analysis
# extends TransientAnalysis(stop = 2.0, alg = "Rodas5P")
# model = TestElectricMotor_Regeneration()
# end
#
# VALIDATION (calculate BEFORE running):
# - Current becomes negative (generating)
# - Motor decelerates
# - Power flows mechanical â†’ electrical
# - Energy recovered
# - Back-EMF > applied voltage causes reverse current
#
# VALIDATION CHECKLIST:
# [ ] Current becomes negative after voltage reduction
# [ ] Motor decelerates
# [ ] Power flows from mechanical to electrical
# [ ] Energy balance verified
# [ ] Generator mode physics correct
# ============================================================================
test component TestElectricMotor_Regeneration
end